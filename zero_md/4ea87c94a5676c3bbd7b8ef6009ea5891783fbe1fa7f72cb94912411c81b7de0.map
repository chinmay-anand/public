{"version":3,"sources":["jsdelivr-header.js","/gh/zerodevx/zero-md@1.3.4/src/zero-md.js"],"names":[],"mappings":"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","file":"/gh/zerodevx/zero-md@1.3.4/src/zero-md.js","sourceRoot":"","sourcesContent":["/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /gh/zerodevx/zero-md@1.3.4/src/zero-md.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n","(function() {\n  window.customElements.define('zero-md', class extends HTMLElement {\n\n    get version() { return 'v1.3.4'; }\n    get src() { return this.getAttribute('src'); }\n    get manualRender() { return this.hasAttribute('manual-render'); }\n    get noShadow() { return this.hasAttribute('no-shadow'); }\n    get markedUrl() { return this.getAttribute('marked-url') || window.ZeroMd.config.markedUrl; }\n    get prismUrl() { return this.getAttribute('prism-url') || window.ZeroMd.config.prismUrl; }\n    get cssUrls() {\n      let attr = this.getAttribute('css-urls');\n      return attr ? JSON.parse(attr) : window.ZeroMd.config.cssUrls;\n    }\n\n    constructor() {\n      super();\n      window.ZeroMd = window.ZeroMd || {};\n      window.ZeroMd.config = window.ZeroMd.config || {};\n      window.ZeroMd.config.markedUrl = window.ZeroMd.config.markedUrl || 'https://cdn.jsdelivr.net/npm/marked@0/marked.min.js';\n      window.ZeroMd.config.prismUrl = window.ZeroMd.config.prismUrl || 'https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js';\n      window.ZeroMd.config.cssUrls = window.ZeroMd.config.cssUrls || ['https://cdn.jsdelivr.net/npm/github-markdown-css@2/github-markdown.min.css', 'https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism.min.css'];\n      window.ZeroMd.cache = window.ZeroMd.cache || {};\n    }\n\n    connectedCallback() {\n      this.addEventListener('click', this._hijackLinks.bind(this));\n      this.addEventListener('zero-md-rendered', function handler() {\n        this.removeEventListener('zero-md-rendered', handler);\n        window.setTimeout(() => { this._scrollTo(window.location.hash); });\n      }.bind(this));\n      if (!this.manualRender) { this.render(); }\n      this._fire('zero-md-ready');\n    }\n\n    _fire(eventName) {\n      this.dispatchEvent(new CustomEvent(eventName, {bubbles: true, composed: true}));\n    }\n\n    _ajaxGet(url) {\n      return new Promise((resolve, reject) => {\n        if (!url) { reject(url); return; }\n        let req = new XMLHttpRequest();\n        let handler = err => {\n          console.warn('[zero-md] Error getting file', url);\n          reject(err);\n        };\n        req.open('GET', url, true);\n        req.onload = () => {\n          if (req.status >= 200 && req.status < 400) { resolve(req.responseText); }\n          else { handler(req); }\n        };\n        req.onerror = err => handler(err);\n        req.send();\n      });\n    }\n\n    _loadScript(url, check, evt, ...attrs) {\n      return new Promise((resolve, reject) => {\n        if (check !== 'undefined') { resolve(); return; }\n        // Handle race condition when multiple instances loaded at runtime\n        if (window.ZeroMd.cache.hasOwnProperty(evt)) {\n          window.addEventListener(evt, function handler() {\n            window.removeEventListener(evt, handler);\n            resolve();\n          });\n        } else {\n          window.ZeroMd.cache[evt] = true;\n          let el = document.createElement('script');\n          for (let attr of attrs) el.setAttribute(attr, '');\n          el.onload = () => { this._fire(evt); resolve(); };\n          el.onerror = err => { console.warn('[zero-md] Error loading script', url); reject(err); };\n          el.src = url;\n          document.head.appendChild(el);\n        }\n      });\n    }\n\n    _getStylesheet(url) {\n      return new Promise((resolve, reject) => {\n        // Check cache if stylesheet already downloaded\n        if (window.ZeroMd.cache[url]) {\n          if (window.ZeroMd.cache[url].loaded) {\n            resolve(window.ZeroMd.cache[url].data);\n          } else {\n            window.addEventListener(url, function handler() {\n              window.removeEventListener(url, handler);\n              resolve(window.ZeroMd.cache[url].data);\n            });\n          }\n        } else {\n          window.ZeroMd.cache[url] = { loaded: false, data: '' };\n          this._ajaxGet(url).then(data => {\n            window.ZeroMd.cache[url].data = data;\n            window.ZeroMd.cache[url].loaded = true;\n            this._fire(url);\n            resolve(data);\n          }, err => reject(err));\n        }\n      });\n    }\n\n    _getInputs() {\n      return new Promise((resolve, reject) => {\n        // First try reading from light DOM template\n        let tpl = this.querySelector('template') && this.querySelector('template').content.querySelector('xmp') || false;\n        if (tpl) { resolve(tpl.textContent); return; }\n        // Next try reading from `src` attribute\n        this._ajaxGet(this.src)\n          .then(data => resolve(data))\n          .catch(err => reject(err));\n      });\n    }\n\n    _prismHighlight(code, lang) {\n      return window.Prism.highlight(code, this._detectLang(code, lang));\n    }\n\n    _detectLang(code, lang) {\n      // Dead simple language detection\n      if (!lang) { return code.match(/^\\s*</) ? window.Prism.languages.markup : window.Prism.languages.javascript; }\n      if (window.Prism.languages.hasOwnProperty(lang)) { return window.Prism.languages[lang]; }\n      if (lang.substr(0, 2) === 'es') { return window.Prism.languages.javascript; }\n      if (lang === 'c') { return window.Prism.languages.clike; }\n      return window.Prism.languages.markup;\n    }\n\n    _stampDom(data) {\n      let nodes = this.querySelectorAll('[class^=markdown]');\n      if (nodes) { nodes.forEach(node => this.removeChild(node)); }\n      if (this.shadowRoot) { this.shadowRoot.innerHTML = ''; }\n      if (this.noShadow) {\n        this.insertAdjacentHTML('afterbegin', data);\n      } else {\n        let root = this.shadowRoot || this.attachShadow({mode: 'open'});\n        root.innerHTML = data;\n      }\n    }\n\n    _buildMd() {\n      return new Promise((resolve, reject) => {\n        Promise.all([this._getInputs(),\n                     this._loadScript(this.markedUrl, typeof window.marked, 'zero-md-marked-ready', 'async'),\n                     this._loadScript(this.prismUrl, typeof window.Prism, 'zero-md-prism-ready', 'async', 'data-manual')])\n          .then(data => {\n            resolve('<div class=\"markdown-body\">' + window.marked(data[0], { highlight: this._prismHighlight.bind(this) }) + '</div>');\n          }, err => { reject(err); });\n      });\n    }\n\n    _buildStyles() {\n      return new Promise(resolve => {\n        let start = '<style class=\"markdown-style\">:host{display:block;position:relative;contain:content;}';\n        let end = '</style>';\n        // First try reading from light DOM template\n        let tpl = this.querySelector('template') && this.querySelector('template').content.querySelector('style') || false;\n        if (tpl) { resolve(start + tpl.textContent + end); return; }\n        // Next try reading from css-urls\n        if (Array.isArray(this.cssUrls) && this.cssUrls.length) {\n          Promise.all(this.cssUrls.map(url => this._getStylesheet(url)))\n            .then(data => resolve(start + data.join('') + end))\n            .catch(() => resolve(start + end));\n        } else {\n          console.warn('[zero-md] No styles are defined');\n          resolve(start + end);\n        }\n      });\n    }\n\n    _scrollTo(selector) {\n      if (!selector || !this.shadowRoot) { return; }\n      let el = this.shadowRoot.getElementById(selector.substr(1));\n      if (el) { el.scrollIntoView(); }\n    }\n\n    _hijackLinks(ev) {\n      let path = ev.path || ev.composedPath();\n      if (path[0].tagName !== 'A') { return; }\n\n      // check that it's a hash-link case\n      const link = path[0];\n      if (link.hash && (link.origin + link.pathname) === (window.location.origin + window.location.pathname)) {\n        if (ev.metaKey) {\n          window.open(link.href, '_blank');\n        } else {\n          this._scrollTo(link.hash);\n          window.location = link.href;\n        }\n        ev.preventDefault();\n      }\n    }\n\n    render() {\n      Promise.all([this._buildStyles(), this._buildMd()])\n        .then(data => {\n          this._stampDom(data[0] + data[1]);\n          this._fire('zero-md-rendered');\n        });\n    }\n  });\n}(window, document));\n"]}
